<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>WARHAMMER — Ultra Showcase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=UnifrakturMaguntia&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --text:#e8e8e8; --muted:#bdbdbd; --gold:#d1a84a; --red:#b31313; --bg:#0a0a0a; --edge:#2a2a2a;
      --shadow:0 12px 28px rgba(0,0,0,.6);
      --glow:0 0 22px rgba(209,168,74,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background: radial-gradient(1200px 600px at 15% 0%, #141414 0%, transparent 60%),
                  radial-gradient(1000px 500px at 100% 100%, #101010 0%, transparent 55%),
                  linear-gradient(180deg, #0b0b0b, #080808);
      color:var(--text);
      font-family: Montserrat, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.65; overflow-x:hidden;
    }

    /* Lienzo WebGL de fondo */
    #bg{
      position:fixed; inset:0; z-index:-2; display:block; background:#000;
    }

    /* Neblina/estelas parallax CSS */
    .parallax, .parallax::before, .parallax::after{
      position:fixed; inset:0; pointer-events:none; z-index:-1;
    }
    .parallax::before{
      content:"";
      background:
        radial-gradient(2px 2px at 20% 30%, #ffffff40, transparent 60%),
        radial-gradient(1.5px 1.5px at 60% 70%, #ffffff30, transparent 60%),
        radial-gradient(1.5px 1.5px at 80% 20%, #ffffff25, transparent 60%),
        radial-gradient(1.2px 1.2px at 40% 80%, #ffffff25, transparent 60%);
      animation: drift 18s linear infinite; opacity:.42;
    }
    .parallax::after{
      content:"";
      background:
        radial-gradient(800px 300px at 10% -10%, #b313130f, transparent 70%),
        radial-gradient(1200px 400px at 100% 110%, #d1a84a15, transparent 75%);
      animation: drift2 22s linear infinite;
    }
    @keyframes drift{to{transform:translateY(28px)}}
    @keyframes drift2{to{transform:translateY(-28px)}}

    /* Contenedor */
    .page{
      max-width: 1080px; margin: clamp(20px,4vw,48px) auto;
      padding: clamp(16px,3vw,32px);
      background:
        linear-gradient(145deg, rgba(255,255,255,.02), rgba(255,255,255,0)),
        linear-gradient(180deg, #0f0f0f, #0a0a0a);
      border:1px solid var(--edge); border-radius:14px; box-shadow:var(--shadow);
      position:relative; overflow:hidden;
      transform: translateY(14px); opacity:0;
      transition: transform .8s ease, opacity .8s ease;
      backdrop-filter: blur(2px);
    }
    .page.reveal{transform:translateY(0);opacity:1}
    .page::before{
      content:""; position:absolute; inset:0; pointer-events:none; border-radius:14px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), inset 0 0 60px rgba(209,168,74,.06);
    }

    /* Título: gradiente dorado + glitch sutil */
    .title{
      font-family:"UnifrakturMaguntia","Cinzel",serif;
      font-size: clamp(46px, 8vw, 110px);
      margin:0 0 14px; text-align:center; letter-spacing:.6px;
      background: linear-gradient(90deg,#6f5520,#ffe08a,#f7cf63,#6f5520);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 2px 0 #000, 0 6px 24px rgba(209,168,74,.35);
      position:relative; user-select:none;
      animation: sheen 5s ease-in-out infinite;
    }
    @keyframes sheen{
      0%,100%{filter: drop-shadow(0 0 0 rgba(209,168,74,0))}
      50%{filter: drop-shadow(0 0 16px rgba(209,168,74,.35))}
    }
    .title::after{
      content:attr(data-title);
      position:absolute; inset:0; text-align:center; color:#ffd27a70; mix-blend-mode:screen;
      clip-path: inset(0 0 48% 0); animation: glitch 2.7s infinite steps(2,end);
    }
    @keyframes glitch{
      0%{transform:translateX(0)} 20%{transform:translateX(1px)}
      21%{transform:translateX(-1px)} 22%{transform:translateX(0)}
      60%{transform:none} 61%{transform:translateX(1px)} 62%{transform:none}
    }

    /* Regla dorada con destello barrido */
    .h-rule{
      width:min(560px,72%); margin:0 auto 22px; height:6px;
      background: linear-gradient(90deg,transparent,var(--gold),transparent);
      border-radius:999px; position:relative; box-shadow:var(--glow); overflow:hidden;
    }
    .h-rule .flare{
      position:absolute; top:-40%; width:120px; height:200%;
      background: radial-gradient(closest-side,#fff,transparent 70%);
      filter: blur(8px); opacity:.28; left:-120px;
      animation: sweep 5s linear infinite;
    }
    @keyframes sweep{to{left:calc(100% + 120px)}}

    h2{
      font-family:"Cinzel",serif; font-weight:800;
      font-size: clamp(22px,3.2vw,34px); color:var(--gold);
      margin:26px 0 10px; text-shadow:0 1px 0 #000;
    }
    p{font-size:clamp(15px,2vw,18px); margin:14px 0; text-align:justify}
    .panel{
      background: linear-gradient(180deg,#101010,#0b0b0b);
      border:1px solid #242424; border-radius:12px;
      padding: clamp(14px, 2.5vw, 22px);
      box-shadow: inset 0 0 40px rgba(0,0,0,.35), 0 8px 24px rgba(0,0,0,.45);
      transform: translateY(12px); opacity:0;
      transition: transform .7s ease, opacity .7s ease;
    }
    .panel.reveal{transform:translateY(0);opacity:1}
    .panel p:first-of-type::first-letter{
      font-family:"Cinzel",serif; font-weight:800; float:left;
      font-size:2.9em; line-height:.88; padding:8px 10px 0 2px; margin-right:8px;
      color:#ffcf66; text-shadow:0 2px 8px rgba(209,168,74,.35);
      transform: translateY(10px); opacity:0; animation: dropin .9s .2s ease forwards;
    }
    @keyframes dropin{to{transform:translateY(0);opacity:1}}

    .hr-metal{
      margin:26px 0; height:2px; border:none;
      background: linear-gradient(90deg,transparent,#666,#bbb,#666,transparent);
      box-shadow:0 0 8px rgba(255,255,255,.08); position:relative; overflow:hidden;
    }
    .hr-metal::after{
      content:""; position:absolute; left:-20%; top:-250%;
      width:40%; height:500%;
      background: conic-gradient(from 0deg, transparent 0 30%, #ffffff22 40% 60%, transparent 70% 100%);
      animation: spin 8s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .actions{text-align:center;margin-top:18px}
    .btn{
      display:inline-block; margin:6px; padding:10px 18px; border-radius:10px;
      border:1px solid #3a3a3a; text-decoration:none; font-weight:700; letter-spacing:.3px;
      background: linear-gradient(180deg,#1c1c1c,#151515); color:#eee;
      box-shadow: 0 4px 14px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.03);
      transition: transform .08s ease, box-shadow .2s ease, filter .2s ease, color .2s ease;
      position:relative; overflow:hidden;
    }
    .btn:hover{
      color:#fff3cf; transform:translateY(-1px);
      box-shadow:0 6px 20px rgba(209,168,74,.25), inset 0 0 0 1px rgba(255,255,255,.06);
      filter: drop-shadow(0 0 10px rgba(209,168,74,.25));
    }
    .btn--gold{
      border-color:#6c560f; background:linear-gradient(180deg,#caa44f,#8e6d27);
      color:#111; text-shadow:0 1px 0 #ffd;
    }
    .btn--danger{
      border-color:#5b1414; background:linear-gradient(180deg,#b31313,#6f0e0e);
    }

    /* Chispas en clic */
    .spark{
      position:absolute; width:3px; height:3px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #ffd, #ffa50090 40%, transparent 70%);
      pointer-events:none; opacity:0; transform:translate(-50%,-50%) scale(.8);
      animation: spark .9s ease-out forwards; filter: blur(.2px);
    }
    @keyframes spark{
      0%{opacity:.0; transform:translate(-50%,-50%) scale(.4)}
      15%{opacity:.95}
      100%{opacity:0; transform:translate(-50%,-110%) scale(1.6)}
    }

    /* Menos animación si el usuario lo pide */
    @media (prefers-reduced-motion: reduce){
      *{animation:none !important; transition:none !important}
      .parallax,.parallax::before,.parallax::after{display:none}
    }
  </style>
</head>
<body>
  <canvas id="bg" aria-hidden="true"></canvas>
  <div class="parallax" aria-hidden="true"></div>

  <main class="page" id="container">
    <h1 class="title" data-title="WARHAMMER">WARHAMMER</h1>
    <div class="h-rule"><span class="flare" aria-hidden="true"></span></div>

    <section class="panel" id="intro">
      <p>Universo de fantasía y ciencia ficción de <strong>Games Workshop</strong>, sinónimo de épica oscura. En <em>Warhammer Fantasy</em>, reinos inspirados en la Europa medieval resisten a dioses caóticos, plagas y razas en guerra. En <em>Warhammer 40,000</em>, el 41.º milenio es un imperio teocrático sitiado por xenos y demonios. El martillo es metáfora de fuerza, disciplina y devastación. El hobby mezcla modelismo, pintura y estrategia: cada ejército es un relato en miniatura y cada mesa, un campo de batalla con cicatrices. Warhammer exagera nuestros fanatismos, imperios y guerras: aquí la paz es un mito y el conflicto, inevitable.</p>
    </section>

    <hr class="hr-metal"/>

    <div class="actions">
      <a class="btn btn--gold" href="./index.html">Inicio</a>
      <a class="btn btn--danger" href="https://www.warhammer.com/" target="_blank" rel="noopener">Sitio oficial</a>
    </div>

    <p class="actions" style="margin-top:8px">
      <span style="color:var(--muted)">Haz clic sobre la página para ver chispas. Mueve el mouse: el martillo responde.</span>
    </p>
  </main>

  <!-- GSAP para coreografías suaves -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" integrity="sha512-tIhTZz0m3U/3x4vGxqfE0JpLQn1Jz0oQFQHqW3kR0m8oY8QbQ7wZ5aYlqfCPuYp9c8q6r3h0N2g9lZ0YIh8kXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- THREE.js (módulos ESM) -->
  <script type="module">
    import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';
    import { OrbitControls } from 'https://unpkg.com/three@0.160.0/examples/jsm/controls/OrbitControls.js';
    import { RoomEnvironment } from 'https://unpkg.com/three@0.160.0/examples/jsm/environments/RoomEnvironment.js';

    // === Setup básico ===
    const canvas = document.getElementById('bg');
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.0;
    renderer.setPixelRatio(Math.min(2, window.devicePixelRatio || 1));
    resize();

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(55, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0.6, 0.5, 2.4);

    // Entorno físico decente sin HDR externo
    const pmremGen = new THREE.PMREMGenerator(renderer);
    const env = new RoomEnvironment();
    const envMap = pmremGen.fromScene(env).texture;
    scene.environment = envMap;

    // Luz dramática
    const key = new THREE.DirectionalLight(0xfff2c5, 2.1);
    key.position.set(2, 3, 2);
    const rim = new THREE.PointLight(0xb31313, 2.2, 6);
    rim.position.set(-1.2, 0.6, 1.2);
    scene.add(key, rim);

    // === Martillo simple (cabeza + mango) ===
    const hammer = new THREE.Group();

    // Cabeza metálica
    const headGeo = new THREE.BoxGeometry(0.9, 0.45, 0.45);
    const metalMat = new THREE.MeshStandardMaterial({
      color: 0x888888, metalness: 1.0, roughness: 0.28, envMapIntensity: 1.0
    });
    const head = new THREE.Mesh(headGeo, metalMat);
    head.castShadow = head.receiveShadow = true;
    head.position.set(0, 0.35, 0);
    hammer.add(head);

    // Punta (golpe) delante
    const tipGeo = new THREE.BoxGeometry(0.18, 0.30, 0.30);
    const tip = new THREE.Mesh(tipGeo, metalMat);
    tip.position.set(0.58, 0.35, 0);
    hammer.add(tip);

    // Mango de “madera oscura”
    const handleGeo = new THREE.CylinderGeometry(0.06, 0.06, 1.5, 32);
    const woodMat = new THREE.MeshStandardMaterial({ color: 0x3a2b1b, metalness: 0.2, roughness: 0.8 });
    const handle = new THREE.Mesh(handleGeo, woodMat);
    handle.position.set(0, -0.5, 0);
    hammer.add(handle);

    // Remaches dorados
    const rivetGeo = new THREE.CylinderGeometry(0.03, 0.03, 0.02, 24);
    const goldMat  = new THREE.MeshStandardMaterial({ color: 0xd1a84a, metalness: 1.0, roughness: 0.25 });
    const rivets = new THREE.Group();
    for(let i=0;i<6;i++){
      const r = new THREE.Mesh(rivetGeo, goldMat);
      r.rotation.x = Math.PI/2;
      r.position.set(-0.3 + i*0.12, 0.50, 0.20);
      rivets.add(r);
      const r2 = r.clone(); r2.position.z = -0.20; rivets.add(r2);
    }
    hammer.add(rivets);

    hammer.rotation.z = Math.PI * -0.22;
    scene.add(hammer);

    // === Partículas ===
    const pCount = 1800;
    const pGeo = new THREE.BufferGeometry();
    const pos = new Float32Array(pCount*3);
    const col = new Float32Array(pCount*3);
    for(let i=0;i<pCount;i++){
      const r = 3 + Math.random()*4;
      const theta = Math.random()*Math.PI*2;
      const y = (Math.random()-0.5)*2.5;
      pos[i*3  ] = Math.cos(theta)*r;
      pos[i*3+1] = y;
      pos[i*3+2] = Math.sin(theta)*r;
      const c = (Math.random()<0.12) ? new THREE.Color(0xd1a84a) : new THREE.Color(0x888888);
      col[i*3]=c.r; col[i*3+1]=c.g; col[i*3+2]=c.b;
    }
    pGeo.setAttribute('position', new THREE.BufferAttribute(pos,3));
    pGeo.setAttribute('color', new THREE.BufferAttribute(col,3));
    const sprite = particleSprite();
    const pMat = new THREE.PointsMaterial({ size: 0.04, map: sprite, vertexColors:true, transparent:true, depthWrite:false });
    const points = new THREE.Points(pGeo, pMat);
    scene.add(points);

    // Controles (por si quieres girar con mouse)
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true; controls.enablePan = false; controls.minDistance = 1.2; controls.maxDistance = 3.6;

    // Pequeño “flicker” en luz roja
    let t = 0;
    function animate(){
      requestAnimationFrame(animate);
      t += 0.01;
      hammer.rotation.y += 0.003;
      rim.intensity = 2.0 + Math.sin(t*3.0)*0.35;
      points.rotation.y -= 0.0008;
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // Interacción: martillo responde al mouse (sutil)
    window.addEventListener('mousemove', (e)=>{
      const x = (e.clientX / window.innerWidth) * 2 - 1;
      const y = (e.clientY / window.innerHeight) * 2 - 1;
      hammer.rotation.x = -0.15 + y*0.12;
      hammer.rotation.z = -0.22 + x*0.12;
    });

    // Sparks al click
    const container = document.getElementById('container');
    let throttle = false;
    container.addEventListener('click', (e)=>{
      if(throttle) return;
      throttle = true; setTimeout(()=>throttle=false, 120);
      for(let i=0;i<4;i++){
        const s = document.createElement('span');
        s.className = 'spark';
        const dx = (Math.random()*28 - 14);
        const dy = (Math.random()*10 - 5);
        s.style.left = (e.clientX + dx) + 'px';
        s.style.top  = (e.clientY + dy) + 'px';
        document.body.appendChild(s);
        setTimeout(()=>s.remove(), 900);
      }
    });

    // Reveal con IntersectionObserver
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){ e.target.classList.add('reveal'); io.unobserve(e.target); }
      });
    }, {threshold:.12});
    document.querySelectorAll('.page,.panel').forEach(el=>io.observe(el));

    // GSAP para una entrada suave del título
    if (window.gsap){
      gsap.fromTo('.title', {y:20, opacity:0}, {y:0, opacity:1, ease:"power3.out", duration:0.9, delay:0.1});
    }

    window.addEventListener('resize', resize);
    function resize(){
      const w = window.innerWidth, h = window.innerHeight;
      renderer.setSize(w,h,false);
      camera.aspect = w/h; camera.updateProjectionMatrix();
    }

    // Genera un sprite circular suave para partículas
    function particleSprite(size=64){
      const c = document.createElement('canvas'); c.width = c.height = size;
      const g = c.getContext('2d');
      const grd = g.createRadialGradient(size/2,size/2,0, size/2,size/2,size/2);
      grd.addColorStop(0,'rgba(255,255,255,0.95)');
      grd.addColorStop(0.4,'rgba(255,255,255,0.6)');
      grd.addColorStop(1,'rgba(255,255,255,0.0)');
      g.fillStyle = grd; g.beginPath(); g.arc(size/2,size/2,size/2,0,Math.PI*2); g.fill();
      const tex = new THREE.CanvasTexture(c); tex.colorSpace = THREE.SRGBColorSpace; return tex;
    }
  </script>

  <noscript>
    <div class="page" style="margin:24px auto;max-width:860px">
      <h1 class="title" data-title="WARHAMMER" style="color:#ffe08a">WARHAMMER</h1>
      <p>Activa JavaScript para ver el fondo 3D y las animaciones. Aun así, el contenido es legible.</p>
    </div>
  </noscript>
</body>
</html>
